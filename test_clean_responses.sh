#!/bin/bash

echo "üß™ Testing Clean Response Format"
echo "================================"
echo ""

# Test 1: Quick Response
echo "Test 1: Quick Response"
echo "Question: 'test'"
echo "Expected: Simple 'Working.' response"
echo ""

response=$(curl -s -X POST https://vias.onrender.com/api/answer-question \
  -H "Content-Type: application/json" \
  -d '{"question": "test", "history": []}' \
  --max-time 10)

echo "Response: $response"
echo ""

# Check if response contains unwanted verbose elements
if [[ $response == *"smile"* ]] || [[ $response == *"emoji"* ]] || [[ $response == *"Hugging Face"* ]] || [[ $response == *"validation"* ]] || [[ $response == *"generated"* ]]; then
  echo "‚ùå FAILED - Response still contains verbose elements"
else
  echo "‚úÖ PASSED - Response is clean"
fi

echo ""
echo "================================"
echo ""

# Test 2: Hello Response
echo "Test 2: Greeting Response"
echo "Question: 'hello'"
echo "Expected: Simple greeting without technical details"
echo ""

response=$(curl -s -X POST https://vias.onrender.com/api/answer-question \
  -H "Content-Type: application/json" \
  -d '{"question": "hello", "history": []}' \
  --max-time 10)

echo "Response: $response"
echo ""

# Check if response is clean
if [[ $response == *"smile"* ]] || [[ $response == *"ü§ó"* ]] || [[ $response == *"AI"* ]] || [[ $response == *"model"* ]]; then
  echo "‚ùå FAILED - Response contains unwanted elements"
else
  echo "‚úÖ PASSED - Response is clean"
fi

echo ""
echo "üéØ SUMMARY"
echo "================================"
echo "Responses should now be:"
echo "‚Ä¢ Direct and simple"
echo "‚Ä¢ No emojis or technical jargon"
echo "‚Ä¢ No 'generated by' or validation messages"
echo "‚Ä¢ Just the answer or 'Unable to find information'"
